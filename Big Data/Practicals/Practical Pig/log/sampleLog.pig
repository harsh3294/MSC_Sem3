log = LOAD 'hdfs://localhost:9000/log/sample.log';


LEVELS = foreach log generate REGEX_EXTRACT($0, '(TRACE|DEBUG|INFO|WARN|ERROR|FATAL)', 1) AS LOGLEVEL; 

FILTEREDLEVELS = FILTER LEVELS BY LOGLEVEL IS NOT NULL; 

GROUPEDLEVELS = GROUP FILTEREDLEVELS BY LOGLEVEL; 

FREQUENCIES= FOREACH GROUPEDLEVELS generate group AS LOGLEVEL , COUNT(FILTEREDLEVELS.LOGLEVEL) AS COUNT; 

RESULT = ORDER FREQUENCIES BY COUNT DESC;
 
DUMP RESULT;

